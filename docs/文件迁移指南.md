# æ–‡ä»¶è¿ç§»æŒ‡å—

## ðŸŽ¯ è¿ç§»ç­–ç•¥

**åŽŸåˆ™**ï¼š
1. **æ ¸å¿ƒä»£ç ** â†’ é‡æž„åŽè¿ç§»åˆ°æ–°é¡¹ç›®
2. **é…ç½®æ–‡ä»¶** â†’ ç›´æŽ¥å¤åˆ¶åˆ°æ–°é¡¹ç›®
3. **API æ–‡æ¡£** â†’ ç›´æŽ¥å¤åˆ¶åˆ°æ–°é¡¹ç›®
4. **æ—§ä»£ç ** â†’ ä¿ç•™åœ¨ `AIå‚è€ƒæ–‡ä»¶å¤¹/` ä½œä¸ºå‚è€ƒ
5. **æµ‹è¯•æ•°æ®** â†’ å¤åˆ¶åˆ°æ–°é¡¹ç›®çš„ `tests/fixtures/`
6. **ä¸´æ—¶æ–‡ä»¶** â†’ ä¸è¿ç§»

---

## ðŸ“¦ è¿ç§»æ¸…å•

### âœ… éœ€è¦ç›´æŽ¥å¤åˆ¶çš„æ–‡ä»¶ï¼ˆæ— éœ€ä¿®æ”¹ï¼‰

#### 1. é…ç½®æ–‡ä»¶
```
æ—§é¡¹ç›®/config/AzureSecretKey.csv
  â†’ æ–°é¡¹ç›®/config/azure_keys.csv

æ—§é¡¹ç›®/.env (å¦‚æžœæœ‰)
  â†’ æ–°é¡¹ç›®/.env
```

#### 2. API æ–‡æ¡£
```
æ—§é¡¹ç›®/api docs/
  â†’ æ–°é¡¹ç›®/docs/api_references/
    â”œâ”€â”€ ç«å±±APIæ–‡æ¡£.txt
    â”œâ”€â”€ azure apiæ–‡æ¡£.txt
    â”œâ”€â”€ è®¯é£žå£°çº¹è¯†åˆ«api.txt
    â”œâ”€â”€ ç«å±±çƒ­è¯.txt
    â””â”€â”€ è…¾è®¯äº‘çƒ­è¯è¡¨.txt (å¤‡ç”¨)
```

#### 3. æµ‹è¯•æ•°æ®
```
æ—§é¡¹ç›®/test_data/
  â†’ æ–°é¡¹ç›®/tests/fixtures/
    â”œâ”€â”€ 20251229ONEäº§å“å’Œä¸šåŠ¡è§„åˆ™ä¸­å¿ƒçš„è®¾è®¡è®¨è®ºä¼šè®®-Corrected-transcript.txt
    â””â”€â”€ 20251229å¯åŠ¨å™¨æœ¬åœ°åŒ–è§£å†³æ–¹æ¡ˆè®¨è®ºä¼šè®®-transcript.txt
```

#### 4. æŠ€æœ¯æ–‡æ¡£
```
æ—§é¡¹ç›®/
  â†’ æ–°é¡¹ç›®/docs/legacy/
    â”œâ”€â”€ é¡¹ç›®å®Œæˆæ€»ç»“.md
    â”œâ”€â”€ è¯„ä¼°é€»è¾‘å®¡æŸ¥æŠ¥å‘Š.md
    â”œâ”€â”€ Azureé…ç½®è¯´æ˜Ž.md
    â””â”€â”€ åˆ†å·®æŒ½æ•‘æœºåˆ¶è¯´æ˜Ž.md (å¦‚æžœæœ‰)
```

---

### ðŸ”„ éœ€è¦é‡æž„åŽè¿ç§»çš„ä»£ç æ–‡ä»¶

è¿™äº›æ–‡ä»¶**ä¸ç›´æŽ¥å¤åˆ¶**ï¼Œè€Œæ˜¯ä½œä¸ºå‚è€ƒï¼Œé‡æž„åŽå†™å…¥æ–°é¡¹ç›®ï¼š

#### 1. ASR è½¬å†™æ¨¡å—
```
å‚è€ƒæ–‡ä»¶ï¼š
  - transcribers/volcano_transcriber_v3.py
  - transcribers/azure_transcriber.py
  - transcribers/transcription_tester.py

é‡æž„ä¸ºï¼š
  â†’ æ–°é¡¹ç›®/src/providers/asr/volcano.py
  â†’ æ–°é¡¹ç›®/src/providers/asr/azure.py
  â†’ æ–°é¡¹ç›®/src/utils/metrics.py (æå–è¯„ä¼°é€»è¾‘)
```

**é‡æž„è¦ç‚¹**ï¼š
- å®žçŽ° `ASRProvider` æŽ¥å£
- ä½¿ç”¨ Pydantic é…ç½®
- æ·»åŠ ç»“æž„åŒ–æ—¥å¿—
- ç»Ÿä¸€å¼‚å¸¸å¤„ç†

#### 2. å£°çº¹è¯†åˆ«æ¨¡å—
```
å‚è€ƒæ–‡ä»¶ï¼š
  - iflytek_voiceprint.py
  - audio_processor.py
  - asr_cluster_corrector.py

é‡æž„ä¸ºï¼š
  â†’ æ–°é¡¹ç›®/src/providers/voiceprint/iflytek.py
  â†’ æ–°é¡¹ç›®/src/utils/audio.py
  â†’ æ–°é¡¹ç›®/src/services/correction.py
```

**é‡æž„è¦ç‚¹**ï¼š
- å®žçŽ° `VoiceprintProvider` æŽ¥å£
- åˆ†ç¦»éŸ³é¢‘å¤„ç†é€»è¾‘åˆ° utils
- ä¿ç•™åˆ†å·®æŒ½æ•‘æœºåˆ¶
- ä¼˜åŒ–é‡‡æ ·ç­–ç•¥

#### 3. LLM æ€»ç»“æ¨¡å—
```
å‚è€ƒæ–‡ä»¶ï¼š
  - meeting_summarizer.py

é‡æž„ä¸ºï¼š
  â†’ æ–°é¡¹ç›®/src/providers/llm/gemini.py
```

**é‡æž„è¦ç‚¹**ï¼š
- æ”¹ç”¨ Gemini APIï¼ˆä¸å†ç”¨ OpenRouterï¼‰
- å®žçŽ° `LLMProvider` æŽ¥å£
- æ”¯æŒå¤šç§æ€»ç»“ç­–ç•¥

#### 4. ä¸»æµç¨‹
```
å‚è€ƒæ–‡ä»¶ï¼š
  - main_pipeline.py

é‡æž„ä¸ºï¼š
  â†’ æ–°é¡¹ç›®/src/services/transcription.py
  â†’ æ–°é¡¹ç›®/src/services/speaker_recognition.py
  â†’ æ–°é¡¹ç›®/src/api/routes.py
```

**é‡æž„è¦ç‚¹**ï¼š
- æ‹†åˆ†ä¸ºå¤šä¸ªæœåŠ¡
- ä½¿ç”¨ä¾èµ–æ³¨å…¥
- æ·»åŠ  Web API æŽ¥å£

---

### ðŸ“š ä¿ç•™åœ¨æ—§é¡¹ç›®ä½œä¸ºå‚è€ƒ

è¿™äº›æ–‡ä»¶ä¿ç•™åœ¨æ—§é¡¹ç›®çš„ `AIå‚è€ƒæ–‡ä»¶å¤¹/`ï¼Œä¾›å¼€å‘æ—¶æŸ¥é˜…ï¼š

```
AIå‚è€ƒæ–‡ä»¶å¤¹/
â”œâ”€â”€ 1_ASRè½¬å†™/
â”‚   â”œâ”€â”€ volcano_transcriber_v3.py      â† å‚è€ƒç«å±±å¼•æ“Žå®žçŽ°
â”‚   â”œâ”€â”€ azure_transcriber.py           â† å‚è€ƒ Azure å®žçŽ°
â”‚   â””â”€â”€ transcription_tester.py        â† å‚è€ƒè¯„ä¼°é€»è¾‘
â”‚
â”œâ”€â”€ 2_å£°çº¹è¯†åˆ«/
â”‚   â”œâ”€â”€ iflytek_voiceprint.py          â† å‚è€ƒè®¯é£žå®žçŽ°
â”‚   â”œâ”€â”€ audio_processor.py             â† å‚è€ƒéŸ³é¢‘å¤„ç†
â”‚   â””â”€â”€ asr_cluster_corrector.py       â† å‚è€ƒä¿®æ­£é€»è¾‘
â”‚
â”œâ”€â”€ 3_ä¸»æµç¨‹/
â”‚   â””â”€â”€ main_pipeline.py               â† å‚è€ƒä¸»æµç¨‹
â”‚
â”œâ”€â”€ 4_LLMæ€»ç»“/
â”‚   â””â”€â”€ meeting_summarizer.py          â† å‚è€ƒæ€»ç»“é€»è¾‘
â”‚
â””â”€â”€ æŠ€æœ¯æ–‡æ¡£/
    â”œâ”€â”€ é¡¹ç›®å®Œæˆæ€»ç»“.md
    â”œâ”€â”€ è¯„ä¼°é€»è¾‘å®¡æŸ¥æŠ¥å‘Š.md
    â””â”€â”€ æ–°é¡¹ç›®è¿ç§»æ¸…å•.md
```

---

### âŒ ä¸éœ€è¦è¿ç§»çš„æ–‡ä»¶

è¿™äº›æ–‡ä»¶æ˜¯ä¸´æ—¶æ–‡ä»¶ã€æµ‹è¯•è„šæœ¬æˆ–å·²è¿‡æœŸçš„ä»£ç ï¼Œä¸éœ€è¦è¿ç§»ï¼š

```
âŒ ä¸è¿ç§»ï¼š
  - test_scripts/          (æ—§çš„æµ‹è¯•è„šæœ¬ï¼Œæ–°é¡¹ç›®é‡å†™)
  - test_results/          (æ—§çš„æµ‹è¯•ç»“æžœ)
  - temp_audio_chunks/     (ä¸´æ—¶æ–‡ä»¶)
  - __pycache__/           (Python ç¼“å­˜)
  - *.pyc                  (ç¼–è¯‘æ–‡ä»¶)
  - organize_files.py      (æ•´ç†è„šæœ¬ï¼Œå·²å®Œæˆä½¿å‘½)
  - æ‰“åŒ…è¿ç§»æ–‡ä»¶.py         (æ‰“åŒ…è„šæœ¬ï¼Œå·²å®Œæˆä½¿å‘½)
  - test_azure_eastasia.py (ä¸´æ—¶æµ‹è¯•)
```

---

## ðŸš€ è¿ç§»æ­¥éª¤

### æ­¥éª¤ 1: åˆ›å»ºæ–°é¡¹ç›®ç›®å½•ç»“æž„

```bash
# åœ¨æ–°çš„å·¥ä½œæ–‡ä»¶å¤¹ä¸­
mkdir -p æ–°é¡¹ç›®/{src,tests,config,docs,scripts}
mkdir -p æ–°é¡¹ç›®/src/{core,config,providers,services,utils,api}
mkdir -p æ–°é¡¹ç›®/src/providers/{asr,voiceprint,llm}
mkdir -p æ–°é¡¹ç›®/tests/{unit,integration,fixtures}
mkdir -p æ–°é¡¹ç›®/docs/{api_references,legacy}
```

### æ­¥éª¤ 2: å¤åˆ¶é…ç½®æ–‡ä»¶

```bash
# ä»Žæ—§é¡¹ç›®å¤åˆ¶
cp æ—§é¡¹ç›®/config/AzureSecretKey.csv æ–°é¡¹ç›®/config/azure_keys.csv
```

### æ­¥éª¤ 3: å¤åˆ¶ API æ–‡æ¡£

```bash
cp -r æ—§é¡¹ç›®/api\ docs/* æ–°é¡¹ç›®/docs/api_references/
```

### æ­¥éª¤ 4: å¤åˆ¶æµ‹è¯•æ•°æ®

```bash
cp -r æ—§é¡¹ç›®/test_data/* æ–°é¡¹ç›®/tests/fixtures/
```

### æ­¥éª¤ 5: å¤åˆ¶æŠ€æœ¯æ–‡æ¡£

```bash
cp æ—§é¡¹ç›®/é¡¹ç›®å®Œæˆæ€»ç»“.md æ–°é¡¹ç›®/docs/legacy/
cp æ—§é¡¹ç›®/è¯„ä¼°é€»è¾‘å®¡æŸ¥æŠ¥å‘Š.md æ–°é¡¹ç›®/docs/legacy/
cp æ—§é¡¹ç›®/Azureé…ç½®è¯´æ˜Ž.md æ–°é¡¹ç›®/docs/legacy/
```

### æ­¥éª¤ 6: å¤åˆ¶æž¶æž„è®¾è®¡æ–‡æ¡£

```bash
cp æ—§é¡¹ç›®/docs/æ–°é¡¹ç›®æž¶æž„è®¾è®¡.md æ–°é¡¹ç›®/docs/
cp æ—§é¡¹ç›®/docs/æž¶æž„ä»£ç ç¤ºä¾‹.py æ–°é¡¹ç›®/docs/
cp æ—§é¡¹ç›®/docs/è¿ç§»å®žæ–½è®¡åˆ’.md æ–°é¡¹ç›®/docs/
cp æ—§é¡¹ç›®/docs/æ–‡ä»¶è¿ç§»æŒ‡å—.md æ–°é¡¹ç›®/docs/
```

### æ­¥éª¤ 7: åˆ›å»º AI å‚è€ƒæ–‡ä»¶å¤¹

```bash
# åœ¨æ—§é¡¹ç›®ä¸­è¿è¡Œæ‰“åŒ…è„šæœ¬
cd æ—§é¡¹ç›®
python æ‰“åŒ…è¿ç§»æ–‡ä»¶.py

# å¤åˆ¶åˆ°æ–°é¡¹ç›®
cp -r æ–°é¡¹ç›®AIå‚è€ƒæ–‡ä»¶å¤¹ æ–°é¡¹ç›®/AIå‚è€ƒæ–‡ä»¶å¤¹
```

### æ­¥éª¤ 8: åˆ›å»ºåŸºç¡€æ–‡ä»¶

```bash
cd æ–°é¡¹ç›®

# åˆ›å»º __init__.py
find src tests -type d -exec touch {}/__init__.py \;

# åˆ›å»º .gitignore
cat > .gitignore << 'EOF'
# Python
__pycache__/
*.py[cod]
*$py.class
*.so
.Python
env/
venv/
.venv/

# é…ç½®æ–‡ä»¶
.env
*.csv
!config/.gitkeep

# ä¸´æ—¶æ–‡ä»¶
temp_audio_chunks/
*.wav
*.mp3
*.ogg

# IDE
.vscode/
.idea/
*.swp

# æµ‹è¯•
.pytest_cache/
.coverage
htmlcov/

# æ—¥å¿—
*.log
logs/
EOF

# åˆ›å»º .env.example
cat > .env.example << 'EOF'
# ç«å±±å¼•æ“Žé…ç½®
VOLCANO_APP_ID=your_app_id
VOLCANO_ACCESS_TOKEN=your_access_token
VOLCANO_TOS_ACCESS_KEY=your_tos_access_key
VOLCANO_TOS_SECRET_KEY=your_tos_secret_key
VOLCANO_TOS_ENDPOINT=https://tos-cn-beijing.volces.com
VOLCANO_TOS_REGION=cn-beijing
VOLCANO_TOS_BUCKET=your_bucket

# è®¯é£žé…ç½®
IFLYTEK_APP_ID=your_app_id
IFLYTEK_API_KEY=your_api_key
IFLYTEK_API_SECRET=your_api_secret
IFLYTEK_GROUP_ID=your_group_id

# Gemini é…ç½®
GEMINI_API_KEY=your_api_key
GEMINI_MODEL=gemini-3-pro

# åº”ç”¨é…ç½®
LOG_LEVEL=INFO
MAX_WORKERS=4
EOF

# åˆ›å»º requirements.txt
cat > requirements.txt << 'EOF'
# Web æ¡†æž¶
fastapi==0.109.0
uvicorn[standard]==0.27.0

# æ•°æ®éªŒè¯
pydantic==2.5.0
pydantic-settings==2.1.0

# HTTP å®¢æˆ·ç«¯
requests==2.31.0
httpx==0.26.0

# éŸ³é¢‘å¤„ç†
pydub==0.25.1

# å­˜å‚¨
tos==2.6.0

# LLM
google-generativeai==0.3.0

# æ—¥å¿—
structlog==24.1.0

# æµ‹è¯•
pytest==7.4.0
pytest-asyncio==0.21.0
pytest-cov==4.1.0

# ä»£ç è´¨é‡
black==23.12.0
ruff==0.1.0
mypy==1.7.0
EOF

# åˆ›å»º README.md
cat > README.md << 'EOF'
# ä¼šè®® AI åŠ©æ‰‹ v2.0

åŸºäºŽ ASR + å£°çº¹è¯†åˆ« + LLM çš„ä¼šè®®å½•éŸ³å®žåè¯†åˆ«ä¸Žæ€»ç»“ç³»ç»Ÿ

## åŠŸèƒ½ç‰¹æ€§

- âœ… ASR è¯­éŸ³è½¬å†™ï¼ˆç«å±±å¼•æ“Ž + Azure å¤‡ç”¨ï¼‰
- âœ… å£°çº¹è¯†åˆ«ï¼ˆè®¯é£žï¼‰
- âœ… ASR èšç±»ä¿®æ­£
- âœ… ä¼šè®®çºªè¦ç”Ÿæˆï¼ˆGeminiï¼‰
- âœ… Web API æŽ¥å£

## å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
pip install -r requirements.txt
```

### 2. é…ç½®çŽ¯å¢ƒå˜é‡

```bash
cp .env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œå¡«å…¥å¯†é’¥
```

### 3. è¿è¡Œæµ‹è¯•

```bash
pytest tests/ -v --cov=src
```

### 4. å¯åŠ¨ API æœåŠ¡

```bash
uvicorn main:app --reload --host 0.0.0.0 --port 8000
```

## é¡¹ç›®ç»“æž„

è¯¦è§ `docs/æ–°é¡¹ç›®æž¶æž„è®¾è®¡.md`

## å¼€å‘æŒ‡å—

è¯¦è§ `docs/è¿ç§»å®žæ–½è®¡åˆ’.md`

## API æ–‡æ¡£

å¯åŠ¨æœåŠ¡åŽè®¿é—®ï¼šhttp://localhost:8000/docs

## å‚è€ƒèµ„æ–™

- æ—§é¡¹ç›®ä»£ç ï¼š`AIå‚è€ƒæ–‡ä»¶å¤¹/`
- API æ–‡æ¡£ï¼š`docs/api_references/`
- æŠ€æœ¯æ–‡æ¡£ï¼š`docs/legacy/`
EOF
```

---

## ðŸ“‹ è¿ç§»æ£€æŸ¥æ¸…å•

å®Œæˆè¿ç§»åŽï¼Œæ£€æŸ¥ä»¥ä¸‹å†…å®¹ï¼š

### æ–‡ä»¶æ£€æŸ¥
- [ ] é…ç½®æ–‡ä»¶å·²å¤åˆ¶ï¼ˆ`config/azure_keys.csv`ï¼‰
- [ ] API æ–‡æ¡£å·²å¤åˆ¶ï¼ˆ`docs/api_references/`ï¼‰
- [ ] æµ‹è¯•æ•°æ®å·²å¤åˆ¶ï¼ˆ`tests/fixtures/`ï¼‰
- [ ] æŠ€æœ¯æ–‡æ¡£å·²å¤åˆ¶ï¼ˆ`docs/legacy/`ï¼‰
- [ ] AI å‚è€ƒæ–‡ä»¶å¤¹å·²åˆ›å»ºï¼ˆ`AIå‚è€ƒæ–‡ä»¶å¤¹/`ï¼‰

### ç›®å½•ç»“æž„æ£€æŸ¥
- [ ] `src/` ç›®å½•ç»“æž„å®Œæ•´
- [ ] `tests/` ç›®å½•ç»“æž„å®Œæ•´
- [ ] `docs/` ç›®å½•ç»“æž„å®Œæ•´
- [ ] `config/` ç›®å½•å­˜åœ¨

### åŸºç¡€æ–‡ä»¶æ£€æŸ¥
- [ ] `.gitignore` å·²åˆ›å»º
- [ ] `.env.example` å·²åˆ›å»º
- [ ] `requirements.txt` å·²åˆ›å»º
- [ ] `README.md` å·²åˆ›å»º
- [ ] æ‰€æœ‰ç›®å½•éƒ½æœ‰ `__init__.py`

### çŽ¯å¢ƒé…ç½®æ£€æŸ¥
- [ ] å¤åˆ¶ `.env.example` ä¸º `.env`
- [ ] å¡«å†™æ‰€æœ‰å¿…éœ€çš„çŽ¯å¢ƒå˜é‡
- [ ] éªŒè¯é…ç½®æ–‡ä»¶è·¯å¾„æ­£ç¡®

---

## ðŸŽ¯ ä¸‹ä¸€æ­¥

è¿ç§»å®ŒæˆåŽï¼ŒæŒ‰ç…§ `docs/è¿ç§»å®žæ–½è®¡åˆ’.md` å¼€å§‹é‡æž„ä»£ç ï¼š

1. **é˜¶æ®µ 1**: å®šä¹‰æ ¸å¿ƒæŠ½è±¡å±‚ï¼ˆæŽ¥å£ã€æ¨¡åž‹ï¼‰
2. **é˜¶æ®µ 2**: å®žçŽ°æä¾›å•†ï¼ˆASRã€å£°çº¹ã€LLMï¼‰
3. **é˜¶æ®µ 3**: å®žçŽ°ä¸šåŠ¡é€»è¾‘å±‚
4. **é˜¶æ®µ 4**: å®žçŽ° API å±‚
5. **é˜¶æ®µ 5**: å®Œå–„å·¥å…·æ¨¡å—
6. **é˜¶æ®µ 6**: æµ‹è¯•ä¸Žæ–‡æ¡£

---

**åˆ›å»ºæ—¶é—´**: 2025-01-12  
**é€‚ç”¨äºŽ**: æ–°é¡¹ç›® v2.0 è¿ç§»
