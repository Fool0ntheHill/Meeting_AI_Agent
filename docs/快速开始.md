# 快速开始指南

本指南帮助你在 5 分钟内运行第一个端到端测试。

## 步骤 1: 准备 API 密钥 (2 分钟)

你需要获取以下 API 密钥:

### 必需的密钥

1. **火山引擎 ASR** (用于语音转写)
   - 访问: https://console.volcengine.com/
   - 开通: 语音技术 → 语音识别
   - 获取: `access_key`, `secret_key`, `app_id`, `cluster_id`
   - 开通: 对象存储 TOS
   - 获取: `tos_bucket`, `tos_region`

2. **Gemini LLM** (用于生成会议纪要)
   - 访问: https://aistudio.google.com/
   - 点击: Get API Key
   - 获取: API 密钥

### 可选的密钥

3. **科大讯飞声纹识别** (用于说话人识别,可跳过)
   - 访问: https://www.xfyun.cn/
   - 开通: 声纹识别服务
   - 获取: `app_id`, `api_key`, `api_secret`, `group_id`

## 步骤 2: 配置文件 (1 分钟)

### 方式 A: 使用配置文件(推荐)

```bash
# 1. 复制配置模板
cp config/test.yaml.example config/test.yaml

# 2. 编辑配置文件,填入 API 密钥
nano config/test.yaml  # 或使用你喜欢的编辑器
```

最小配置示例:

```yaml
env: test
debug: true

volcano:
  access_key: "你的火山引擎 access_key"
  secret_key: "你的火山引擎 secret_key"
  app_id: "你的火山引擎 app_id"
  cluster_id: "你的火山引擎 cluster_id"
  tos_bucket: "你的 TOS bucket 名称"
  tos_region: cn-beijing

gemini:
  api_keys:
    - "你的 Gemini API 密钥"
  model: gemini-2.0-flash-exp
  max_tokens: 8192
  temperature: 0.7

log:
  level: INFO
```

### 方式 B: 使用环境变量

```bash
# 设置环境变量
export VOLCANO_ACCESS_KEY="你的火山引擎 access_key"
export VOLCANO_SECRET_KEY="你的火山引擎 secret_key"
export VOLCANO_APP_ID="你的火山引擎 app_id"
export VOLCANO_CLUSTER_ID="你的火山引擎 cluster_id"
export VOLCANO_TOS_BUCKET="你的 TOS bucket 名称"
export GEMINI_API_KEY_1="你的 Gemini API 密钥"
```

## 步骤 3: 准备测试音频 (1 分钟)

准备一个会议录音文件:

```bash
# 创建测试数据目录
mkdir -p test_data

# 将你的音频文件放入此目录
# 例如: test_data/meeting.wav
```

**音频要求**:
- 格式: WAV, MP3, M4A 等
- 时长: 建议 1-5 分钟(首次测试)
- 内容: 包含对话的会议录音

**没有测试音频?** 可以使用手机录制一段简短的对话。

## 步骤 4: 运行测试 (1 分钟)

### 基础测试(跳过说话人识别)

```bash
python scripts/test_e2e.py \
  --audio test_data/meeting.wav \
  --skip-speaker-recognition \
  --config config/test.yaml
```

### 完整测试(包含说话人识别)

如果你配置了科大讯飞 API:

```bash
python scripts/test_e2e.py \
  --audio test_data/meeting.wav \
  --config config/test.yaml
```

## 预期输出

成功运行后,你会看到:

```
================================================================================
开始端到端集成测试
================================================================================

[1/7] 初始化服务...
✓ 服务初始化完成

[2/7] 准备测试数据...
✓ 任务 ID: test_task_xxx
✓ 音频文件: ['test_data/meeting.wav']

[3/7] 开始管线处理...
Task xxx: Starting transcription phase
Task xxx: Transcription completed, duration=120.5s, segments=45
Task xxx: Starting correction phase
Task xxx: Correction completed
Task xxx: Starting artifact generation phase
Task xxx: Artifact generation completed
✓ 管线处理完成

[4/7] 处理结果:
  - Artifact ID: art_xxx
  - 内容类型: meeting_minutes
  - 版本: 1

[5/7] 会议纪要内容:
{
  "title": "测试会议",
  "participants": ["说话人 0", "说话人 1"],
  "summary": "会议摘要...",
  "key_points": ["要点1", "要点2"],
  "action_items": ["行动项1"]
}

[6/7] 统计信息:
  - 参与者数量: 2
  - 关键要点数量: 2
  - 行动项数量: 1

[7/7] 测试完成!
================================================================================
✓ 端到端集成测试成功
================================================================================
```

## 常见问题

### Q1: 配置文件加载失败

**错误**: `No such file or directory: 'config/test.yaml'`

**解决**:
```bash
# 确保配置文件存在
ls -la config/test.yaml

# 如果不存在,复制模板
cp config/test.yaml.example config/test.yaml
```

### Q2: API 密钥无效

**错误**: `Authentication failed`

**解决**:
1. 检查配置文件中的 API 密钥是否正确
2. 确认 API 服务已开通
3. 检查密钥是否有引号包裹

### Q3: 音频文件不存在

**错误**: `音频文件不存在: test_data/meeting.wav`

**解决**:
```bash
# 检查文件路径
ls -la test_data/meeting.wav

# 使用绝对路径
python scripts/test_e2e.py --audio /path/to/your/meeting.wav
```

### Q4: 网络连接超时

**错误**: `Connection timeout`

**解决**:
1. 检查网络连接
2. 确认防火墙设置
3. 尝试使用代理(如果在国内)

### Q5: 跳过说话人识别

如果没有配置科大讯飞 API,使用 `--skip-speaker-recognition`:

```bash
python scripts/test_e2e.py \
  --audio test_data/meeting.wav \
  --skip-speaker-recognition
```

## 进阶用法

### 测试多文件拼接

```bash
python scripts/test_e2e.py \
  --audio part1.wav part2.wav part3.wav \
  --file-order 0 1 2
```

### 指定会议描述

```bash
python scripts/test_e2e.py \
  --audio meeting.wav \
  --description "产品规划会议 - 讨论 Q2 路线图"
```

### 查看详细日志

编辑配置文件,设置日志级别:

```yaml
log:
  level: DEBUG  # 改为 DEBUG
```

## 下一步

测试成功后,你可以:

1. **查看详细文档**: [测试配置指南](./测试配置指南.md)
2. **了解系统架构**: [设计文档](../.kiro/specs/meeting-minutes-agent/design.md)
3. **继续开发**: 实现数据库层、API 层等功能
4. **部署上线**: 参考部署文档

## 获取帮助

```bash
# 查看帮助信息
python scripts/test_e2e.py --help

# 查看详细文档
cat docs/测试配置指南.md
```

## 技术支持

- 项目文档: `docs/`
- API 文档: `api docs/`
- 设计文档: `.kiro/specs/meeting-minutes-agent/design.md`
