# Phase 2 任务已添加到 tasks.md

## 完成时间
2026-01-14

## 更新内容

已将用户建议的改进任务正式添加到 `.kiro/specs/meeting-minutes-agent/tasks.md` 中。

## 新增任务概览

### Task 32: JWT 鉴权实现 (P0 - 严重)
- 32.1 实现开发者登录接口
- 32.2 实现 JWT 验证中间件
- 32.3 替换所有接口的认证方式
- 32.4 添加 JWT 配置

**预计工作量**: 7 小时

### Task 33: LLM 真实调用集成 (P0 - 严重)
- 33.1 连接 ArtifactGenerationService 到 API
- 33.2 配置 Gemini API
- 33.3 端到端测试

**预计工作量**: 4 小时

### Task 34: 热词连接到 ASR (P0 - 严重)
- 34.1 任务创建时读取热词
- 34.2 Worker 传递热词到服务层
- 34.3 TranscriptionService 使用热词

**预计工作量**: 4 小时

### Task 35: 数据库迁移 (Alembic) (P1 - 中等)
- 35.1 初始化 Alembic
- 35.2 生成基线迁移
- 35.3 为新字段创建迁移
- 35.4 更新文档

**预计工作量**: 4 小时

### Task 36: 所有权检查完善 (P1 - 中等)
- 36.1 创建所有权验证依赖
- 36.2 审计所有任务相关接口
- 36.3 应用所有权检查

**预计工作量**: 4 小时

### Task 37: 速率限制实现 (P1 - 中等)
- 37.1 实现速率限制中间件
- 37.2 集成到 API 应用
- 37.3 添加限流响应

**预计工作量**: 4 小时

### Task 38: 多租户配置化 (P1 - 中等)
- 38.1 添加租户配置
- 38.2 自动填充 tenant_id
- 38.3 添加租户隔离中间件 (可选)

**预计工作量**: 5 小时

### Task 39: 成本预估优化 (P1 - 中等)
- 39.1 配置化价格表
- 39.2 根据实际模型计算成本

**预计工作量**: 3 小时

### Task 40: 热词库治理 (P2 - 较低)
- 40.1 添加热词数量上限
- 40.2 添加热词去重和校验

**预计工作量**: 2 小时

### Task 41: Swagger 文档集成 (P2 - 较低)
- 41.1 集成 Swagger UI
- 41.2 完善 API 文档

**预计工作量**: 3 小时

### Task 42: 监控埋点 (P2 - 较低)
- 42.1 记录关键指标
- 42.2 集成 Prometheus

**预计工作量**: 4 小时

### Task 43: Phase 2 检查点
- 验证所有 P0 任务完成
- 验证核心功能可用
- 验证安全性
- 准备上线部署

## 优先级说明

### 🔴 P0 - 严重 (必须立即完成)
**任务**: Task 32, 33, 34
**工作量**: 15 小时
**完成时间**: 第 1 周

这些任务解决核心功能缺失:
- JWT 鉴权避免技术债务
- LLM 真实调用交付核心价值
- 热词连接提升准确率

### 🟡 P1 - 中等 (下个迭代完成)
**任务**: Task 35, 36, 37, 38, 39
**工作量**: 20 小时
**完成时间**: 第 2 周

这些任务提升系统鲁棒性:
- 数据库迁移保证可维护性
- 所有权检查防止越权
- 速率限制防止滥用
- 多租户配置化简化使用
- 成本预估优化

### 🟢 P2 - 较低 (上线前完成)
**任务**: Task 40, 41, 42
**工作量**: 9 小时
**完成时间**: 第 3 周

这些任务优化体验:
- 热词库治理
- Swagger 文档
- 监控埋点

## 总体时间估算

| 优先级 | 任务数 | 预计工作量 | 建议完成时间 |
|--------|--------|------------|--------------|
| P0 | 3 | 15 小时 | 本周内 |
| P1 | 5 | 20 小时 | 下周内 |
| P2 | 3 | 9 小时 | 上线前 |
| **总计** | **11** | **44 小时** | **2-3 周** |

## 关键里程碑

### ✅ 第 1 周结束
- 完成所有 P0 任务
- 核心功能闭环
- 可以生成真实的会议摘要
- JWT 鉴权就绪

### ✅ 第 2 周结束
- 完成所有 P1 任务
- 安全加固完成
- 数据库迁移就绪
- 可以进入测试环境

### ✅ 第 3 周结束
- 完成所有 P2 任务
- 生产就绪
- 文档完善
- 可以上线

## 风险评估

| 风险 | 严重程度 | 当前状态 | 对应任务 | 缓解措施 |
|------|----------|----------|----------|----------|
| 身份传递不规范 | 🔴 严重 | 未实现 JWT | Task 32 | P0 立即实现 |
| LLM 生成是占位符 | 🔴 严重 | 未连接服务 | Task 33 | P0 立即连接 |
| 热词未生效 | 🟡 中等 | 未连接 ASR | Task 34 | P0 立即连接 |
| 越权访问 | 🟡 中等 | 部分检查 | Task 36 | P1 完善检查 |
| 数据库迁移缺失 | 🟡 中等 | 无迁移脚本 | Task 35 | P1 初始化 Alembic |
| 成本预估不准 | 🟢 较低 | 硬编码价格 | Task 39 | P1 配置化 |

## 实施建议

### 第 1 周重点 (P0 任务)

**Day 1-2: JWT 鉴权**
1. 创建 `src/api/routes/auth.py`
2. 实现 `/auth/dev/login` 接口
3. 实现 JWT 验证中间件
4. 替换所有接口认证

**Day 3: LLM 真实调用**
1. 连接 `ArtifactGenerationService`
2. 移除占位符
3. 端到端测试

**Day 4-5: 热词连接**
1. 任务创建时读取热词
2. Worker 传递热词
3. ASR 使用热词

### 第 2 周重点 (P1 任务)

**Day 1-2: 数据库迁移 + 所有权检查**
1. 初始化 Alembic
2. 生成迁移脚本
3. 创建所有权验证依赖
4. 审计并修复接口

**Day 3: 速率限制**
1. 实现限流中间件
2. 测试限流效果

**Day 4-5: 多租户配置 + 成本优化**
1. 添加租户配置
2. 自动填充 tenant_id
3. 配置化价格表

### 第 3 周重点 (P2 任务)

**Day 1: 热词治理**
**Day 2: Swagger 文档**
**Day 3-4: 监控埋点**
**Day 5: 集成测试与上线准备**

## 相关文档

- [tasks.md](.kiro/specs/meeting-minutes-agent/tasks.md) - 完整任务列表
- [improvement_roadmap.md](docs/improvement_roadmap.md) - 详细实施方案
- [requirements.md](.kiro/specs/meeting-minutes-agent/requirements.md) - 需求文档
- [design.md](.kiro/specs/meeting-minutes-agent/design.md) - 设计文档

## 下一步

建议按以下顺序开始实施:

1. **Task 33: LLM 真实调用** (最快见效,4 小时)
   - 立即可以看到真实的会议摘要
   - 验证核心功能可用

2. **Task 34: 热词连接** (提升准确率,4 小时)
   - 热词库立即生效
   - ASR 准确率提升

3. **Task 32: JWT 鉴权** (最重要,7 小时)
   - 避免技术债务
   - 为未来企微对接做准备

完成这三个 P0 任务后,系统就可以交付核心价值了！
